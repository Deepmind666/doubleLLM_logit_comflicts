# 算法流程与参数（M2）

## 1. 主流程 S1~S8

### S1 同题双模型生成
- 输入：问题 `Q`、标准化提示模板 `P`
- 处理：向模型A、模型B并行请求，得到 `OA`、`OB`
- 输出：`OA`、`OB`、可选解释 `TA`、`TB`

### S2 结构化切分
- 输入：`OA`、`OB`
- 处理：句法切分 + 规则抽取，形成论点单元集合 `PA`、`PB`
- 输出：`PA`、`PB`

### S3 对齐匹配
- 输入：`PA`、`PB`
- 处理：计算 `match_score = w1*semantic + w2*rule + w3*position`
- 阈值：`match_score >= 【相似度阈值】` 进入候选匹配
- 输出：匹配关系集合 `M`

### S4 分歧识别
- 输入：`M`
- 处理：NLI模型 + 规则 + 数值校验联合判定
- 输出：分歧点集合 `D` 与类型标签

### S5 分歧解耦
- 输入：`D`、`PA`、`PB`
- 处理：为每个 `d∈D` 生成子问题 `q_d`，抽取 `rA_d`、`rB_d`
- 输出：子问题集合 `Q_D`

### S6 证据裁决（可选默认开启）
- 输入：`Q_D`
- 处理：构建证据检索计划，执行检索，得到 `E_d`；子问题级裁决得到 `J_d`
- 证据源分级：`L1权威数据库/标准法规` > `L2行业资料` > `L3百科/社区`
- 裁决门控：
  - 若仅命中 `L3`，默认不自动定论，进入多解保留
  - 至少命中 `L1` 或两个相互独立的 `L2` 才允许自动裁决
- 输出：`E_d`、`J_d`

### S7 融合合成
- 输入：`PA`、`PB`、`D`、`J_d`
- 处理：合并共识内容，按裁决或多解策略处理分歧
- 输出：最终融合输出 `F` 与分歧映射表

### S8 迭代收敛（可选）
- 输入：`F`、`E_d`、上一轮统计
- 停止条件：
  - `|D_t| <= D_min`
  - `iter >= 【最大迭代次数】`
  - `elapsed >= T_max`
- 输出：收敛后的 `F*`

## 2. 可选分支

### 分支B1：无证据模式
- 跳过 S6
- 在 S7 中保留多解并标记待验证区

### 分支B2：资源受限模式
- 启用预算调度：`budget = f(|D|, confidence_gap, device_state)`
- 对高风险分歧点优先分配检索与裁决资源

## 3. 关键参数建议

- `【相似度阈值】`：0.72~0.86  
- `【NLI阈值】`：0.70~0.90  
- `【最大迭代次数】`：2~5  
- `D_min`：1~3  
- `T_max`：30~180 秒（按场景）

## 4. 复杂度与工程约束

- 对齐匹配近似复杂度：`O(|PA|*|PB|)`，可通过候选剪枝降到近似线性。  
- 检索模块延迟主要受外部源影响，建议并行检索与缓存。  
- 裁决记录与审计日志需持久化以满足复核与合规要求。
- 对低等级证据启用门控，避免低可信来源导致误裁决。

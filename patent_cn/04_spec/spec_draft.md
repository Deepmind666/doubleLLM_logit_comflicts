# 说明书（草案）

## 一、发明名称

双大模型逻辑分歧的自动检测与结构化解耦算法

## 二、技术领域

本发明涉及自然语言处理、人工智能推理一致性控制、可解释生成与多模型协同处理技术领域，具体涉及一种针对模型A与模型B输出分歧的自动检测、结构化解耦、子问题裁决与融合输出的方法、装置、电子设备及计算机可读存储介质。

## 三、背景技术

现有基于大语言模型的内容生成系统，在复杂问题下常出现输出不一致、事实冲突、边界条件不统一或结论互斥。常见处理方式包括投票、整体打分或单轮裁判。这类方案存在以下不足：

1. 难以定位具体冲突位置，人工核查需要逐段比对，成本高。  
2. 多数系统仅给出整体优劣分，缺少可执行的分歧拆解与局部裁决机制。  
3. 缺少证据计划与追溯链路，结果可复核性和合规审计能力不足。  
4. 在资源受限环境下缺少面向分歧规模的动态调度和收敛控制。

因此，需要一种能够将双模型分歧自动定位、结构化解耦并可追溯融合的技术方案。

## 四、发明内容

### 4.1 目的

本发明旨在提供一种双大模型逻辑分歧自动检测与结构化解耦方法，以解决现有技术中分歧定位粗糙、可解释性不足、证据裁决不成体系以及资源调度不稳定等问题。

### 4.2 技术问题

本发明至少解决以下技术问题：

1. 如何在同题双模型输出中自动定位分歧点并进行类型化表示。  
2. 如何将分歧点转化为可验证子问题，并在有证据与无证据两种场景下完成可解释融合。  
3. 如何在资源受限条件下动态调度并通过迭代达到分歧收敛。  
4. 如何建立输入输出合规检测与审计记录机制。

### 4.3 技术方案

本发明提供一种方法，参见图2，至少包括以下步骤：

- `S1`：获取同一输入问题 `Q`，经101获取与标准化模块处理后，分别发送至模型A（102A）和模型B（102B），得到输出 `OA`、`OB`。  
- `S2`：通过103解析切分模块，将 `OA`、`OB` 分解为论点单元集合 `PA`、`PB`，并写入主题标签、段落编号、证据引用位。  
- `S3`：通过104对齐匹配模块，基于语义相似度、规则约束和位置约束建立匹配关系集合 `M`。  
- `S4`：通过105分歧识别模块，对 `M` 执行蕴含/矛盾/无关/缺失判定，得到分歧点集合 `D`，并分类为矛盾、遗漏、假设冲突、边界冲突、数值差异或概念差异。  
- `S5`：通过106结构化解耦模块，将每个分歧点转换为子问题 `q_d`，并抽取双方依据片段 `rA_d`、`rB_d`。  
- `S6`：可选地，通过107证据与裁决模块执行证据检索计划，得到证据 `E_d` 与结构化裁决记录 `J_d`。  
- `S7`：通过108融合输出模块将一致部分和分歧部分融合，输出固定结构结果 `F`，包括共识区、分歧区、裁决区和待验证区，并附 `provenance`。  
- `S8`：可选地，通过110预算调度与迭代控制模块，在满足收敛条件前重复 S2~S7。

上述过程由109存储审计与合规模块记录日志、证据索引、模型版本和合规检测结果。

### 4.4 差异化特征

本发明至少包含以下差异化特征中的若干项：

1. 分歧图谱建模（论点单元节点 + 蕴含/矛盾/依赖边）；  
2. 最小冲突集提取；  
3. 分歧类型多级分类器（NLI+规则+数值校验）；  
4. 子问题可验证性约束；  
5. 证据优先级队列（按信息增益排序）；  
6. 固定模板融合输出与来源追溯字段；  
7. 资源受限预算调度；  
8. 安全与合规过滤模块。

### 4.5 有益效果

相对于现有方案，本发明具有以下效果：

1. 分歧定位精度提高，支持论点级而非段落级冲突识别。  
2. 输出可解释性提高，每个争议点均可回溯到来源段落和裁决记录。  
3. 人工核对时间下降，降低审查与复核成本。  
4. 在证据可用场景下可显著降低互斥结论输出概率。  
5. 在证据不可用场景下可保留多解并明确待验证项，避免误导性单结论。  
6. 动态预算调度使系统在单机资源限制下保持稳定收敛。  
7. 合规模块可降低隐私和违规输出风险，增强可审计性。

## 五、附图说明

- 图1：系统总体架构图。  
- 图2：方法流程图（S1~S8）。  
- 图3：分歧图谱示意图。  
- 图4：结构化解耦与子问题树示意图。  
- 图5：迭代收敛反馈环示意图。  
- 图6：融合输出数据结构示意图。

## 六、附图标记说明

- 101：获取与标准化模块  
- 102A：模型A推理模块  
- 102B：模型B推理模块  
- 103：解析切分模块  
- 104：对齐匹配模块  
- 105：分歧识别模块  
- 106：结构化解耦模块  
- 107：证据与裁决模块  
- 108：融合输出模块  
- 109：存储审计与合规模块  
- 110：预算调度与迭代控制模块

## 七、具体实施方式

### 7.1 术语定义

- 模型A/模型B：两个不同参数、架构或来源的大语言模型。  
- 论点单元：由输出中拆分得到的最小可比较语义单元。  
- 分歧点：同一主题下出现矛盾、缺失或边界冲突的结构化对象。  
- 结构化解耦：将分歧点转换为可独立裁决的子问题并回填融合结果。  
- 裁决记录 `J_d`：包含分歧点标识、裁决结论、置信度、证据索引、多解标记。  

### 7.2 实施例1（无外部证据，仅结构化拆解+多解保留）

1. 执行 S1~S5 获取分歧点集合。  
2. 跳过 S6，直接执行 S7。  
3. 对无法判定的分歧点写入待验证区并设置 `keep_multi_solution=true`。  
4. 输出中强制携带来源段落映射，供后续人工复核。  

该实施例适合外部证据不可用或实时约束较强的场景。

### 7.3 实施例2（带外部证据检索与裁决回填）

1. 执行 S1~S5 后，对每个 `q_d` 生成证据检索计划。  
2. 证据源至少包括内部知识库与外部权威数据库。  
3. 按信息增益执行检索并形成 `E_d`。  
4. 子问题级裁决器输出支持A、支持B或保留多解。  
5. 将 `J_d` 回填至融合输出 `F` 的裁决区，并附证据编号。  

该实施例适合准确性优先和可追溯要求高的场景。

在本实施例中，证据源按可信度分级：L1（权威数据库/标准法规）高于L2（行业资料），L2高于L3（百科/社区）。当仅获得L3证据时系统不自动定论，默认保留多解；当命中至少一条L1证据或两条相互独立的L2证据时，允许自动裁决并记录 `auto_applied=true`。

### 7.4 实施例3（单机 CPU+GPU 调度与迭代收敛）

1. 根据分歧数量和置信度差计算预算函数：`budget = α*|D| + β*conf_gap + γ*risk_level`。  
2. 高风险分歧点优先分配检索和裁决预算。  
3. 每轮迭代后统计 `|D_t|`，当 `|D_t|<=D_min` 或达到 `【最大迭代次数】` 或时间上限 `T_max` 时停止。  
4. 输出收敛曲线和资源消耗日志。

该实施例适合算力受限设备部署。

### 7.5 参数示例

- 相似度阈值：`【相似度阈值】`（建议 0.72~0.86）  
- NLI阈值：`【NLI阈值】`（建议 0.70~0.90）  
- 最大迭代次数：`【最大迭代次数】`（建议 2~5）

### 7.6 数据结构示例

可采用如下字段集合：

- 论点单元：`unit_id`、`topic`、`type`、`text`、`source_para`、`confidence`  
- 分歧点：`divergence_id`、`divergence_type`、`nli_label`、`nli_conf`  
- 裁决记录：`judgment_id`、`decision`、`decision_confidence`、`evidence_ids`  
- 融合输出：`consensus_section`、`divergence_section`、`adjudication_section`、`pending_section`、`provenance`

### 7.7 合规与安全

在输入和输出阶段执行隐私、歧视和违法风险检测。对不合规内容执行屏蔽或改写，并在审计日志中记录触发规则、处理动作和时间戳。

此外，对证据裁决执行证据门控检查，记录 `evidence_gate_check` 字段，防止低可信来源触发错误自动裁决。

## 八、工业实用性

本发明可应用于智能问答、企业知识助手、研发决策辅助、法律检索辅助、医疗问答复核等需要高一致性和可解释性的场景，具备明确工程实现路径和产业落地价值。
